{"remainingRequest":"/home/danijel/Documents/Workspace/KUM-web/frontend/node_modules/babel-loader/lib/index.js!/home/danijel/Documents/Workspace/KUM-web/frontend/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/home/danijel/Documents/Workspace/KUM-web/frontend/src/middleware/authWRoleCheck.js","dependencies":[{"path":"/home/danijel/Documents/Workspace/KUM-web/frontend/src/middleware/authWRoleCheck.js","mtime":1555105557755},{"path":"/home/danijel/Documents/Workspace/KUM-web/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1549443809249},{"path":"/home/danijel/Documents/Workspace/KUM-web/frontend/node_modules/babel-loader/lib/index.js","mtime":1549443804466},{"path":"/home/danijel/Documents/Workspace/KUM-web/frontend/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1549443808667}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport { store } from \"@/store/index.js\";\nimport router from \"@/router/index.js\";\nexport default function auth(to, from, next) {\n  console.log(\"-1\");\n  store.dispatch(\"authUser\").then(function () {\n    console.log(\"0\");\n\n    if (!store.state.user) {\n      router.push({\n        name: 'SignUp'\n      });\n      console.log(\"1\");\n      store.state.lastRoute = to;\n    } else if (!to.meta.allowedRoles.includes(store.state.user.role.roleLevel)) {\n      router.push({\n        name: 'Home'\n      });\n      console.log(\"2\");\n    } else {\n      next();\n    }\n  });\n}",{"version":3,"sources":["/home/danijel/Documents/Workspace/KUM-web/frontend/src/middleware/authWRoleCheck.js"],"names":["store","router","auth","to","from","next","console","log","dispatch","then","state","user","push","name","lastRoute","meta","allowedRoles","includes","role","roleLevel"],"mappings":";;AAAA,SAAQA,KAAR,QAAoB,kBAApB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AAEA,eAAe,SAASC,IAAT,CAAcC,EAAd,EAAkBC,IAAlB,EAAwBC,IAAxB,EAA8B;AACzCC,EAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ;AACAP,EAAAA,KAAK,CAACQ,QAAN,CAAe,UAAf,EAA2BC,IAA3B,CAAgC,YAAM;AAClCH,IAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;;AACA,QAAI,CAACP,KAAK,CAACU,KAAN,CAAYC,IAAjB,EAAuB;AACnBV,MAAAA,MAAM,CAACW,IAAP,CAAY;AAACC,QAAAA,IAAI,EAAE;AAAP,OAAZ;AACAP,MAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;AACAP,MAAAA,KAAK,CAACU,KAAN,CAAYI,SAAZ,GAAwBX,EAAxB;AACH,KAJD,MAIM,IAAG,CAACA,EAAE,CAACY,IAAH,CAAQC,YAAR,CAAqBC,QAArB,CAA8BjB,KAAK,CAACU,KAAN,CAAYC,IAAZ,CAAiBO,IAAjB,CAAsBC,SAApD,CAAJ,EAAmE;AACrElB,MAAAA,MAAM,CAACW,IAAP,CAAY;AAACC,QAAAA,IAAI,EAAE;AAAP,OAAZ;AACAP,MAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;AACH,KAHK,MAGD;AACDF,MAAAA,IAAI;AACP;AACJ,GAZD;AAaD","sourcesContent":["import {store} from \"@/store/index.js\"\nimport router from \"@/router/index.js\"\n\nexport default function auth(to, from, next) {\n    console.log(\"-1\")\n    store.dispatch(\"authUser\").then(() => {\n        console.log(\"0\")\n        if (!store.state.user) {\n            router.push({name: 'SignUp'})\n            console.log(\"1\")\n            store.state.lastRoute = to\n        }else if(!to.meta.allowedRoles.includes(store.state.user.role.roleLevel)){\n            router.push({name: 'Home'})\n            console.log(\"2\")\n        }else{\n            next()\n        }\n    })\n  }"]}]}